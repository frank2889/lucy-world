import{r as a,c as N,j as u}from"./index-CaUPr3nC.js";import{P}from"./PlatformToolLayout-BYh0qkdb.js";const R=[{value:"web",label:"Web"},{value:"news",label:"News"},{value:"videos",label:"Video"}],F=i=>{const{keyword:S,setKeyword:x,searchLanguage:v,country:O,ui:p}=i,o=S??"",[t,k]=a.useState("web"),[j,f]=a.useState([]),[E,b]=a.useState(!1),[B,s]=a.useState(null),l=a.useRef(!1),e=a.useMemo(()=>N(p),[p]),h=a.useMemo(()=>R.map(r=>({...r,label:e(`platform.brave.source.${r.value}`,r.label)})),[e]),n=a.useCallback(async r=>{const y=r.trim();if(!y){f([]),s(null);return}b(!0),s(null);try{const m=new URLSearchParams({q:y,lang:(v||"").toLowerCase(),source:t}),c=await fetch(`/api/platforms/brave?${m.toString()}`);if(!c.ok){const g=await c.json().catch(()=>null);throw new Error(g?.error||e("platform.brave.error.fetch","Unable to fetch Brave suggestions"))}const d=await c.json(),w=(Array.isArray(d?.suggestions)?d.suggestions:[]).map((g,C)=>({title:g,subtitle:e("platform.brave.subtitle","Brave ({{source}})",{source:d?.metadata?.source||t}),metric:e("platform.brave.metric.rank","Suggestion #{{rank}}",{rank:C+1})}));f(w),w.length===0&&s(e("platform.brave.error.none","No Brave suggestions found for this keyword."))}catch(m){const c=m instanceof Error?m.message:e("platform.brave.error.generic","Unknown error");s(c),f([])}finally{b(!1)}},[t,v,e]);a.useEffect(()=>{if(!o.trim()){f([]),s(null),l.current=!1;return}l.current||(l.current=!0,n(o))},[o,n]),a.useEffect(()=>{o.trim()&&l.current&&n(o)},[t,o,n]);const L=a.useMemo(()=>u.jsx("div",{className:"platform-tool__filters",children:u.jsxs("label",{htmlFor:"brave-source",children:[e("platform.brave.filters.source","Source"),u.jsx("select",{id:"brave-source",value:t,onChange:r=>{k(r.target.value),l.current=!1},children:h.map(r=>u.jsx("option",{value:r.value,children:r.label},r.value))})]})}),[t,h,e]);return u.jsx(P,{platformName:e("platform.brave.meta.name","Brave"),keyword:o,onKeywordChange:x,onSearch:n,description:e("platform.brave.description","Privacy-focused Brave Search suggestions."),extraFilters:L,results:j,placeholder:e("platform.brave.placeholder","Which query do you want to explore?"),loading:E,error:B,emptyState:e("platform.brave.empty","Enter a keyword to see Brave suggestions."),controls:i.locationControls,onGlobalSearch:i.onGlobalSearch,globalLoading:i.globalLoading,translate:e})};export{F as default};
