import{r as o,j as f}from"./index-Cb5Uq9R4.js";import{P as C}from"./PlatformToolLayout-rep_d1Yz.js";const v=[{code:"213",label:"Россия — Москва",countries:["RU"]},{code:"2",label:"Россия — Санкт-Петербург",countries:["RU"]},{code:"187",label:"Україна",countries:["UA"]},{code:"157",label:"Беларусь",countries:["BY"]},{code:"163",label:"Қазақстан",countries:["KZ"]},{code:"225",label:"Россия — вся страна",countries:["RU"]},{code:"0",label:"Все регионы",countries:[]}],R=n=>{const h=(n||"").toUpperCase(),g=v.find(s=>s.countries.includes(h));return g?g.code:"225"},G=n=>{const{keyword:h,setKeyword:g,searchLanguage:s,country:y}=n,t=h??"",[a,x]=o.useState(()=>R(y)),[S,m]=o.useState([]),[j,w]=o.useState(!1),[E,l]=o.useState(null),c=o.useRef(!1),z=o.useMemo(()=>{const e=new Map;for(const r of v)e.has(r.code)||e.set(r.code,{code:r.code,label:r.label});return Array.from(e.values())},[]);o.useEffect(()=>{x(R(y))},[y]);const i=o.useCallback(async e=>{const r=e.trim();if(!r){m([]),l(null);return}w(!0),l(null);try{const u=new URLSearchParams({q:r,lr:a});s&&u.set("lang",s.toLowerCase());const d=await fetch(`/api/platforms/yandex?${u.toString()}`);if(!d.ok){const p=await d.json().catch(()=>null);throw new Error(p?.error||"Onbekende Yandex fout")}const b=await d.json(),k=(Array.isArray(b?.suggestions)?b.suggestions:[]).map((p,Y)=>({title:p,subtitle:`Запрос (${b?.region||a||"все регионы"})`,metric:`Популярность #${Y+1}`}));m(k),k.length===0&&l("Geen Yandex suggesties gevonden voor dit zoekwoord.")}catch(u){const d=u instanceof Error?u.message:"Onbekende fout";l(d),m([])}finally{w(!1)}},[a,s]);o.useEffect(()=>{if(!t.trim()){m([]),l(null),c.current=!1;return}c.current||(c.current=!0,i(t))},[t,i]),o.useEffect(()=>{t.trim()&&c.current&&i(t)},[a,s,t,i]);const L=f.jsx("div",{className:"platform-tool__filters",children:f.jsxs("label",{htmlFor:"yandex-region",children:["Regio",f.jsx("select",{id:"yandex-region",value:a,onChange:e=>{x(e.target.value),c.current=!1},children:z.map(e=>f.jsx("option",{value:e.code,children:e.label},e.code))})]})});return f.jsx(C,{platformName:"Yandex",keyword:t,onKeywordChange:g,onSearch:i,description:"Lokale zoektermen voor Yandex ecosysteem.",extraFilters:L,results:S,placeholder:"Welke Russische zoekterm onderzoek je?",loading:j,error:E,emptyState:"Voer een zoekwoord in voor Yandex inzichten.",controls:n.locationControls,onGlobalSearch:n.onGlobalSearch,globalLoading:n.globalLoading})};export{G as default};
