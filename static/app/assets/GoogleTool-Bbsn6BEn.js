import{r as o,c as P,j as G}from"./index-BqAUk1Ix.js";import{P as M}from"./PlatformToolLayout-BVIQfinc.js";const v=a=>{const{keyword:k,setKeyword:C,searchLanguage:f,country:m,ui:l}=a,[L,c]=o.useState([]),[x,d]=o.useState(!1),[j,s]=o.useState(null),e=o.useMemo(()=>P(l),[l]),h=o.useMemo(()=>(f||l?.lang||"en").split("-")[0].toLowerCase(),[f,l?.lang]),i=o.useMemo(()=>(m||"").trim().toUpperCase(),[m]),y=o.useCallback(async p=>{const w=p.trim();if(!w){c([]),s(null);return}d(!0),s(null);try{const n=new URLSearchParams({q:w,lang:h||"en"});i&&n.set("country",i);const b=await fetch(`/api/platforms/google?${n.toString()}`),t=await b.json().catch(()=>({}));if(!b.ok)throw new Error(t?.error||e("platform.google.error.fetch"));const S=(Array.isArray(t?.suggestions)?t.suggestions:[]).map((r,E)=>{let g=null;if(typeof r=="string"?g=r:r&&typeof r=="object"&&(g=r.phrase||r.keyword||r.text||null),!g)return null;const u=[];return t?.metadata?.hl&&u.push(e("platform.google.subtitle.language",{language:t.metadata.hl.toUpperCase()})),t?.metadata?.gl&&u.push(e("platform.google.subtitle.country",{country:t.metadata.gl})),{title:g,subtitle:u.length?u.join(" â€¢ "):e("platform.google.result.subtitle"),metric:e("platform.google.result.rank",{rank:E+1})}}).filter(Boolean);c(S),S.length===0&&s(e("platform.google.error.none"))}catch(n){s(n?.message||e("platform.google.error.generic")),c([])}finally{d(!1)}},[h,i,e]),R=o.useCallback(p=>{y(p)},[y]);return G.jsx(M,{platformName:e("platform.google.meta.name"),keyword:k||"",onKeywordChange:C,onSearch:R,description:e("platform.google.description"),results:L,placeholder:e("platform.google.placeholder"),loading:x,error:j,emptyState:e("platform.google.empty"),controls:a.locationControls,onGlobalSearch:a.onGlobalSearch,globalLoading:a.globalLoading,translate:e})};export{v as default};
