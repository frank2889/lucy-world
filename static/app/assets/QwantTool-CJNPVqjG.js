import{r as a,c as F,j as i}from"./index-C-suCUV6.js";import{P as M}from"./PlatformToolLayout-Dv7YUvVj.js";const O=[{value:"opensearch",label:"OpenSearch"},{value:"toolbar",label:"Toolbar"},{value:"mobile",label:"Mobile"}],U=q=>{const{keyword:S,setKeyword:v,searchLanguage:w,ui:d,locationControls:k,onGlobalSearch:x,globalLoading:E}=q,r=S??"",[o,j]=a.useState("opensearch"),[C,u]=a.useState([]),[L,g]=a.useState(!1),[Q,n]=a.useState(null),s=a.useRef(!1),e=a.useMemo(()=>F(d),[d]),h=a.useMemo(()=>O.map(t=>({...t,label:e(`platform.qwant.client.${t.value}`,t.label)})),[e]),l=a.useCallback(async t=>{const y=t.trim();if(!y){u([]),n(null);return}g(!0),n(null);try{const f=new URLSearchParams({q:y,lang:(w||"").toLowerCase(),client:o}),c=await fetch(`/api/platforms/qwant?${f.toString()}`);if(!c.ok){const p=await c.json().catch(()=>null);throw new Error(p?.error||e("platform.qwant.errors.fetch","Unable to fetch Qwant suggestions"))}const m=await c.json(),b=(Array.isArray(m?.suggestions)?m.suggestions:[]).map((p,N)=>({title:p,subtitle:e("platform.qwant.results.subtitle","Qwant ({{client}})",{client:m?.metadata?.client||o}),metric:e("platform.qwant.results.rank","Suggestion #{{rank}}",{rank:N+1})}));u(b),b.length===0&&n(e("platform.qwant.errors.noneFound","No Qwant suggestions found for this keyword."))}catch(f){const c=f instanceof Error?f.message:e("platform.qwant.errors.generic","Unknown error");n(c),u([])}finally{g(!1)}},[o,w,e]);a.useEffect(()=>{if(!r.trim()){u([]),n(null),s.current=!1;return}s.current||(s.current=!0,l(r))},[r,l]),a.useEffect(()=>{r.trim()&&s.current&&l(r)},[o,r,l]);const T=a.useMemo(()=>i.jsx("div",{className:"platform-tool__filters",children:i.jsxs("label",{htmlFor:"qwant-client",children:[e("platform.qwant.filters.client","Client"),i.jsx("select",{id:"qwant-client",value:o,onChange:t=>{j(t.target.value),s.current=!1},children:h.map(t=>i.jsx("option",{value:t.value,children:t.label},t.value))})]})}),[o,h,e]);return i.jsx(M,{platformName:e("platform.qwant.meta.name","Qwant"),keyword:r,onKeywordChange:v,onSearch:l,description:e("platform.qwant.description","European search engine Qwant autocomplete."),extraFilters:T,results:C,placeholder:e("platform.qwant.placeholder","Which search term would you like to inspect?"),loading:L,error:Q,emptyState:e("platform.qwant.emptyState","Enter a keyword to see Qwant suggestions."),controls:k,onGlobalSearch:x,globalLoading:E,translate:e})};export{U as default};
