import{r as t,c as j,j as x}from"./index-DNWYoPKs.js";import{P as C}from"./PlatformToolLayout-YowsWSnA.js";const T=n=>{const{keyword:h,setKeyword:y,searchLanguage:u,ui:m}=n,e=h??"",[w,l]=t.useState([]),[S,d]=t.useState(!1),[E,a]=t.useState(null),i=t.useRef(!1),r=t.useMemo(()=>j(m),[m]),o=t.useCallback(async L=>{const p=L.trim();if(!p){l([]),a(null);return}d(!0),a(null);try{const c=new URLSearchParams({q:p,lang:(u||"").toLowerCase()}),s=await fetch(`/api/platforms/baidu?${c.toString()}`);if(!s.ok){const f=await s.json().catch(()=>null);throw new Error(f?.error||r("platform.baidu.error.fetch"))}const g=await s.json(),b=(Array.isArray(g?.suggestions)?g.suggestions:[]).map((f,k)=>({title:f,subtitle:r("platform.baidu.subtitle"),metric:r("platform.baidu.metric.rank",{rank:k+1})}));l(b),b.length===0&&a(r("platform.baidu.error.none"))}catch(c){const s=c instanceof Error?c.message:r("platform.baidu.error.generic");a(s),l([])}finally{d(!1)}},[u,r]);return t.useEffect(()=>{if(!e.trim()){l([]),a(null),i.current=!1;return}i.current||(i.current=!0,o(e))},[e,o]),t.useEffect(()=>{e.trim()&&i.current&&o(e)},[u,e,o]),x.jsx(C,{platformName:r("platform.baidu.meta.name"),keyword:e,onKeywordChange:y,onSearch:o,description:r("platform.baidu.description"),results:w,placeholder:r("platform.baidu.placeholder"),loading:S,error:E,emptyState:r("platform.baidu.empty"),controls:n.locationControls,onGlobalSearch:n.onGlobalSearch,globalLoading:n.globalLoading,translate:r})};export{T as default};
