import{r as o,c as U,j as p}from"./index-B_bW3Ap_.js";import{P as F}from"./PlatformToolLayout-D8L_NNlt.js";const b=[{code:"wt-wt",label:"Wereldwijd"},{code:"us-en",label:"United States (English)"},{code:"uk-en",label:"United Kingdom (English)"},{code:"nl-nl",label:"Nederland (Nederlands)"},{code:"de-de",label:"Deutschland (Deutsch)"},{code:"fr-fr",label:"France (Français)"},{code:"es-es",label:"España (Español)"},{code:"it-it",label:"Italia (Italiano)"},{code:"jp-jp",label:"日本 (日本語)"},{code:"in-en",label:"India (English)"},{code:"br-pt",label:"Brasil (Português)"}],K=new Set(b.map(a=>a.code.toLowerCase())),I="wt-wt",L=(a,w)=>{const n=(a||"").split("-")[0].toLowerCase(),c=(w||"").split("-")[0].toLowerCase();if(n&&c){const t=`${c}-${n}`;if(K.has(t))return t}if(n)for(const t of b){const u=t.code.toLowerCase();if(u.endsWith(`-${n}`)||u.startsWith(`${n}-`))return u}return I},q=a=>{const{keyword:w,setKeyword:n,searchLanguage:c,country:t,ui:u}=a,l=w??"",[i,D]=o.useState(()=>L(c,t)),[j,m]=o.useState([]),[x,E]=o.useState(!1),[R,d]=o.useState(null),g=o.useRef(!1),e=o.useMemo(()=>U(u),[u]),S=o.useMemo(()=>b.map(r=>({...r,label:e(`platform.duckduckgo.region.${r.code}`,r.label)})),[e]);o.useEffect(()=>{D(L(c,t))},[c,t]);const f=o.useCallback(async r=>{const C=r.trim();if(!C){m([]),d(null);return}E(!0),d(null);try{const h=new URLSearchParams({q:C,kl:i,lang:(c||"").toLowerCase(),country:(t||"").toUpperCase()}),k=await fetch(`/api/platforms/duckduckgo?${h.toString()}`);if(!k.ok){const s=await k.json().catch(()=>null);throw new Error(s?.error||e("platform.duckduckgo.error.fetch","Unable to fetch DuckDuckGo suggestions"))}const y=await k.json(),G=(Array.isArray(y?.suggestions)?y.suggestions:[]).filter(s=>typeof s?.phrase=="string"&&s.phrase.trim().length>0).map((s,N)=>({title:s.phrase,subtitle:s.snippet||e("platform.duckduckgo.subtitle","DuckDuckGo ({{region}})",{region:y?.kl||i}),metric:typeof s.score=="number"&&Number.isFinite(s.score)?e("platform.duckduckgo.metric.score","Relevance score {{score}}",{score:s.score}):e("platform.duckduckgo.metric.rank","Suggestion #{{rank}}",{rank:N+1})}));m(G),G.length===0&&d(e("platform.duckduckgo.error.none","No DuckDuckGo suggestions found for this keyword."))}catch(h){const k=h instanceof Error?h.message:e("platform.duckduckgo.error.generic","Unknown error");d(k),m([])}finally{E(!1)}},[i,c,t,e]);o.useEffect(()=>{if(!l.trim()){m([]),d(null),g.current=!1;return}g.current||(g.current=!0,f(l))},[l,f]),o.useEffect(()=>{l.trim()&&g.current&&f(l)},[i,l,f]);const v=o.useMemo(()=>p.jsx("div",{className:"platform-tool__filters",children:p.jsxs("label",{htmlFor:"duckduckgo-region",children:[e("platform.duckduckgo.filters.region","Region"),p.jsx("select",{id:"duckduckgo-region",value:i,onChange:r=>{D(r.target.value),g.current=!1},children:S.map(r=>p.jsx("option",{value:r.code,children:r.label},r.code))})]})}),[i,S,e]);return p.jsx(F,{platformName:e("platform.duckduckgo.meta.name","DuckDuckGo"),keyword:l,onKeywordChange:n,onSearch:f,description:e("platform.duckduckgo.description","Discover privacy-friendly queries with DuckDuckGo autocomplete."),extraFilters:v,results:j,placeholder:e("platform.duckduckgo.placeholder","Which query do you want to explore?"),loading:x,error:R,emptyState:e("platform.duckduckgo.empty","Enter a keyword to see DuckDuckGo suggestions."),controls:a.locationControls,onGlobalSearch:a.onGlobalSearch,globalLoading:a.globalLoading,translate:e})};export{q as default};
