import{r,c as K,j as u}from"./index-C9S1em3K.js";import{P as M}from"./PlatformToolLayout-Cr6iLB8k.js";const G=i=>{const{keyword:x,setKeyword:j,searchLanguage:d,country:P,ui:v,uiFallback:g}=i,a=x??"",[o,k]=r.useState("web"),[E,f]=r.useState([]),[L,h]=r.useState(!1),[C,s]=r.useState(null),l=r.useRef(!1),e=r.useMemo(()=>K(v,g),[v,g]),w=r.useMemo(()=>[{value:"web",label:e("platform.brave.source.web")},{value:"news",label:e("platform.brave.source.news")},{value:"videos",label:e("platform.brave.source.videos")}],[e]),n=r.useCallback(async t=>{const y=t.trim();if(!y){f([]),s(null);return}h(!0),s(null);try{const m=new URLSearchParams({q:y,lang:(d||"").toLowerCase(),source:o}),c=await fetch(`/api/platforms/brave?${m.toString()}`);if(!c.ok){const b=await c.json().catch(()=>null);throw new Error(b?.error||e("platform.brave.error.fetch"))}const p=await c.json(),S=(Array.isArray(p?.suggestions)?p.suggestions:[]).map((b,R)=>({title:b,subtitle:e("platform.brave.subtitle",{source:p?.metadata?.source||o}),metric:e("platform.brave.metric.rank",{rank:R+1})}));f(S),S.length===0&&s(e("platform.brave.error.none"))}catch(m){const c=m instanceof Error?m.message:e("platform.brave.error.generic");s(c),f([])}finally{h(!1)}},[o,d,e]);r.useEffect(()=>{if(!a.trim()){f([]),s(null),l.current=!1;return}l.current||(l.current=!0,n(a))},[a,n]),r.useEffect(()=>{a.trim()&&l.current&&n(a)},[o,a,n]);const F=r.useMemo(()=>u.jsx("div",{className:"platform-tool__filters",children:u.jsxs("label",{htmlFor:"brave-source",children:[e("platform.brave.filters.source"),u.jsx("select",{id:"brave-source",value:o,onChange:t=>{k(t.target.value),l.current=!1},children:w.map(t=>u.jsx("option",{value:t.value,children:t.label},t.value))})]})}),[o,w,e]);return u.jsx(M,{platformName:e("platform.brave.meta.name"),keyword:a,onKeywordChange:j,onSearch:n,description:e("platform.brave.description"),extraFilters:F,results:E,placeholder:e("platform.brave.placeholder"),loading:L,error:C,emptyState:e("platform.brave.empty"),controls:i.locationControls,onGlobalSearch:i.onGlobalSearch,globalLoading:i.globalLoading,translate:e})};export{G as default};
