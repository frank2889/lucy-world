import{r as o,c as R,j as c}from"./index-C6i-a171.js";import{P as I}from"./PlatformToolLayout-Z7gxyS7o.js";const K=[5,10,15,20],_=h=>{const u=Number(h);return Number.isFinite(u)?Math.min(Math.max(Math.round(u),1),20):10},U=h=>{const{keyword:u,setKeyword:L,searchLanguage:g,country:p,ui:S,uiFallback:w,locationControls:v,onGlobalSearch:k,globalLoading:E}=h,r=u??"",[a,C]=o.useState(()=>_(void 0)),[F,m]=o.useState([]),[M,b]=o.useState(!1),[N,s]=o.useState(null),n=o.useRef(!1),t=o.useMemo(()=>R(S,w),[S,w]),l=o.useCallback(async e=>{const x=e.trim();if(!x){m([]),s(null);return}b(!0),s(null);try{const f=new URLSearchParams({q:x,lang:(g||"").toLowerCase(),country:(p||"").toUpperCase(),limit:String(a)}),i=await fetch(`/api/platforms/yahoo?${f.toString()}`);if(!i.ok){const d=await i.json().catch(()=>null);throw new Error(d?.error||t("platform.yahoo.errors.fetch"))}const y=await i.json(),j=(Array.isArray(y?.suggestions)?y.suggestions:[]).map((d,P)=>({title:d,subtitle:t("platform.yahoo.results.subtitle",{country:y?.country||p||"global"}),metric:t("platform.yahoo.results.rank",{rank:P+1})}));m(j),j.length===0&&s(t("platform.yahoo.errors.noneFound"))}catch(f){const i=f instanceof Error?f.message:t("platform.yahoo.errors.generic");s(i),m([])}finally{b(!1)}},[a,g,p,t]);o.useEffect(()=>{if(!r.trim()){m([]),s(null),n.current=!1;return}n.current||(n.current=!0,l(r))},[r,l]),o.useEffect(()=>{r.trim()&&n.current&&l(r)},[a,r,l]);const T=o.useMemo(()=>c.jsx("div",{className:"platform-tool__filters",children:c.jsxs("label",{htmlFor:"yahoo-limit",children:[t("platform.yahoo.filters.limit"),c.jsx("select",{id:"yahoo-limit",value:a,onChange:e=>{C(Number(e.target.value)),n.current=!1},children:K.map(e=>c.jsx("option",{value:e,children:e},e))})]})}),[a,t]);return c.jsx(I,{platformName:t("platform.yahoo.meta.name"),keyword:r,onKeywordChange:L,onSearch:l,description:t("platform.yahoo.description"),extraFilters:T,results:F,placeholder:t("platform.yahoo.placeholder"),loading:M,error:N,emptyState:t("platform.yahoo.emptyState"),controls:v,onGlobalSearch:k,globalLoading:E,translate:t})};export{U as default};
