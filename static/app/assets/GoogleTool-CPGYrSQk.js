import{r as o,c as G,j as M}from"./index-C9S1em3K.js";import{P as T}from"./PlatformToolLayout-Cr6iLB8k.js";const A=r=>{const{keyword:C,setKeyword:L,searchLanguage:f,country:m,ui:l,uiFallback:d}=r,[x,c]=o.useState([]),[j,h]=o.useState(!1),[R,s]=o.useState(null),e=o.useMemo(()=>G(l,d),[l,d]),y=o.useMemo(()=>(f||l?.lang||"en").split("-")[0].toLowerCase(),[f,l?.lang]),i=o.useMemo(()=>(m||"").trim().toUpperCase(),[m]),b=o.useCallback(async p=>{const w=p.trim();if(!w){c([]),s(null);return}h(!0),s(null);try{const n=new URLSearchParams({q:w,lang:y||"en"});i&&n.set("country",i);const S=await fetch(`/api/platforms/google?${n.toString()}`),t=await S.json().catch(()=>({}));if(!S.ok)throw new Error(t?.error||e("platform.google.error.fetch"));const k=(Array.isArray(t?.suggestions)?t.suggestions:[]).map((a,P)=>{let g=null;if(typeof a=="string"?g=a:a&&typeof a=="object"&&(g=a.phrase||a.keyword||a.text||null),!g)return null;const u=[];return t?.metadata?.hl&&u.push(e("platform.google.subtitle.language",{language:t.metadata.hl.toUpperCase()})),t?.metadata?.gl&&u.push(e("platform.google.subtitle.country",{country:t.metadata.gl})),{title:g,subtitle:u.length?u.join(" â€¢ "):e("platform.google.result.subtitle"),metric:e("platform.google.result.rank",{rank:P+1})}}).filter(Boolean);c(k),k.length===0&&s(e("platform.google.error.none"))}catch(n){s(n?.message||e("platform.google.error.generic")),c([])}finally{h(!1)}},[y,i,e]),E=o.useCallback(p=>{b(p)},[b]);return M.jsx(T,{platformName:e("platform.google.meta.name"),keyword:C||"",onKeywordChange:L,onSearch:E,description:e("platform.google.description"),results:x,placeholder:e("platform.google.placeholder"),loading:j,error:R,emptyState:e("platform.google.empty"),controls:r.locationControls,onGlobalSearch:r.onGlobalSearch,globalLoading:r.globalLoading,translate:e})};export{A as default};
