import{r as t,c as R,j as c}from"./index-C-suCUV6.js";import{P as T}from"./PlatformToolLayout-Dv7YUvVj.js";const P=[5,10,15,20],U=f=>{const u=Number(f);return Number.isFinite(u)?Math.min(Math.max(Math.round(u),1),20):10},q=f=>{const{keyword:u,setKeyword:k,searchLanguage:d,country:p,ui:w,locationControls:j,onGlobalSearch:L,globalLoading:v}=f,e=u??"",[a,E]=t.useState(()=>U(void 0)),[N,m]=t.useState([]),[Y,S]=t.useState(!1),[C,s]=t.useState(null),n=t.useRef(!1),o=t.useMemo(()=>R(w),[w]),l=t.useCallback(async r=>{const b=r.trim();if(!b){m([]),s(null);return}S(!0),s(null);try{const h=new URLSearchParams({q:b,lang:(d||"").toLowerCase(),country:(p||"").toUpperCase(),limit:String(a)}),i=await fetch(`/api/platforms/yahoo?${h.toString()}`);if(!i.ok){const g=await i.json().catch(()=>null);throw new Error(g?.error||o("platform.yahoo.errors.fetch","Unable to fetch Yahoo suggestions"))}const y=await i.json(),x=(Array.isArray(y?.suggestions)?y.suggestions:[]).map((g,F)=>({title:g,subtitle:o("platform.yahoo.results.subtitle","Yahoo ({{country}})",{country:y?.country||p||"global"}),metric:o("platform.yahoo.results.rank","Suggestion #{{rank}}",{rank:F+1})}));m(x),x.length===0&&s(o("platform.yahoo.errors.noneFound","No Yahoo suggestions found for this keyword."))}catch(h){const i=h instanceof Error?h.message:o("platform.yahoo.errors.generic","Unknown error");s(i),m([])}finally{S(!1)}},[a,d,p,o]);t.useEffect(()=>{if(!e.trim()){m([]),s(null),n.current=!1;return}n.current||(n.current=!0,l(e))},[e,l]),t.useEffect(()=>{e.trim()&&n.current&&l(e)},[a,e,l]);const M=t.useMemo(()=>c.jsx("div",{className:"platform-tool__filters",children:c.jsxs("label",{htmlFor:"yahoo-limit",children:[o("platform.yahoo.filters.limit","Results"),c.jsx("select",{id:"yahoo-limit",value:a,onChange:r=>{E(Number(r.target.value)),n.current=!1},children:P.map(r=>c.jsx("option",{value:r,children:r},r))})]})}),[a,o]);return c.jsx(T,{platformName:o("platform.yahoo.meta.name","Yahoo"),keyword:e,onKeywordChange:k,onSearch:l,description:o("platform.yahoo.description","Yahoo searches with autocomplete suggestions."),extraFilters:M,results:N,placeholder:o("platform.yahoo.placeholder","What are you searching for?"),loading:Y,error:C,emptyState:o("platform.yahoo.emptyState","Enter a keyword to see Yahoo suggestions."),controls:j,onGlobalSearch:L,globalLoading:v,translate:o})};export{q as default};
