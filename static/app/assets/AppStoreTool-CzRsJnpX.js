import{r as t,j as u}from"./index-Cb5Uq9R4.js";import{P as z}from"./PlatformToolLayout-rep_d1Yz.js";const A=[{code:"US",label:"United States"},{code:"GB",label:"United Kingdom"},{code:"CA",label:"Canada"},{code:"AU",label:"Australia"},{code:"DE",label:"Germany"},{code:"FR",label:"France"},{code:"ES",label:"Spain"},{code:"IT",label:"Italy"},{code:"NL",label:"Netherlands"},{code:"BE",label:"Belgium"},{code:"JP",label:"Japan"}],w=a=>{const p=(a||"").toUpperCase();return A.find(n=>n.code===p)?.code??"US"},B=a=>{const{keyword:p,setKeyword:g,country:n}=a,o=p??"",[d,y]=t.useState(()=>w(n)),[E,m]=t.useState([]),[j,b]=t.useState(!1),[k,s]=t.useState(null),l=t.useRef(!1),x=t.useMemo(()=>A,[]);t.useEffect(()=>{y(w(n))},[n]);const c=t.useCallback(async r=>{const S=r.trim();if(!S){m([]),s(null);return}b(!0),s(null);try{const f=new URLSearchParams({q:S,country:d,limit:"15"}),i=await fetch(`/api/platforms/appstore?${f.toString()}`);if(!i.ok){const e=await i.json().catch(()=>null);throw new Error(e?.error||"Onbekende App Store fout")}const h=await i.json(),v=(Array.isArray(h?.results)?h.results:[]).map((e,C)=>{const P=e.trackName||S,U=[e.artistName,e.primaryGenreName].filter(Boolean),N=typeof e.averageUserRating=="number"?`${e.averageUserRating.toFixed(1)}★${e.userRatingCount?` (${e.userRatingCount.toLocaleString()})`:""}`:null,O=e.formattedPrice||(typeof e.price=="number"?`${e.price===0?"Free":`${e.price} ${e.currency||""}`}`:null),$=[N,O].filter(Boolean);return{title:P,subtitle:U.join(" • ")||void 0,metric:$.join(" • ")||`Populariteit #${C+1}`}});m(v),v.length===0&&s("Geen App Store suggesties gevonden voor dit zoekwoord.")}catch(f){const i=f instanceof Error?f.message:"Onbekende fout";s(i),m([])}finally{b(!1)}},[d]);t.useEffect(()=>{if(!o.trim()){m([]),s(null),l.current=!1;return}l.current||(l.current=!0,c(o))},[o,c]),t.useEffect(()=>{o.trim()&&l.current&&c(o)},[d,o,c]);const R=u.jsx("div",{className:"platform-tool__filters",children:u.jsxs("label",{htmlFor:"appstore-country",children:["Store",u.jsx("select",{id:"appstore-country",value:d,onChange:r=>{y(r.target.value),l.current=!1},children:x.map(r=>u.jsx("option",{value:r.code,children:r.label},r.code))})]})});return u.jsx(z,{platformName:"App Store",keyword:o,onKeywordChange:g,onSearch:c,description:"ASO (App Store Optimization) voor iOS applicaties.",extraFilters:R,results:E,placeholder:"Welke app zoekterm onderzoek je?",loading:j,error:k,emptyState:"Voer een zoekwoord in voor App Store suggesties.",controls:a.locationControls,onGlobalSearch:a.onGlobalSearch,globalLoading:a.globalLoading})};export{B as default};
