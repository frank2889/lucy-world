import{r as e,c as M,j as m}from"./index-VHqiCOIl.js";import{P as R}from"./PlatformToolLayout-CvAcjWun.js";const h={opensearch:"OpenSearch",toolbar:"Toolbar",mobile:"Mobile"},B=S=>{const{keyword:v,setKeyword:L,searchLanguage:d,ui:b,locationControls:x,onGlobalSearch:j,globalLoading:E}=S,r=v??"",[n,C]=e.useState("opensearch"),[k,p]=e.useState([]),[A,g]=e.useState(!1),[F,l]=e.useState(null),s=e.useRef(!1),t=e.useMemo(()=>M(b),[b]),q=e.useMemo(()=>{const a=t("platform.qwant.client.opensearch"),i=t("platform.qwant.client.toolbar"),o=t("platform.qwant.client.mobile");return[{value:"opensearch",label:a==="platform.qwant.client.opensearch"?h.opensearch:a},{value:"toolbar",label:i==="platform.qwant.client.toolbar"?h.toolbar:i},{value:"mobile",label:o==="platform.qwant.client.mobile"?h.mobile:o}]},[t]),c=e.useCallback(async a=>{const i=a.trim();if(!i){p([]),l(null);return}g(!0),l(null);try{const o=new URLSearchParams({q:i,lang:(d||"").toLowerCase(),client:n}),u=await fetch(`/api/platforms/qwant?${o.toString()}`);if(!u.ok){const w=await u.json().catch(()=>null);throw new Error(w?.error||t("platform.qwant.errors.fetch"))}const f=await u.json(),y=(Array.isArray(f?.suggestions)?f.suggestions:[]).map((w,K)=>({title:w,subtitle:t("platform.qwant.results.subtitle",{client:f?.metadata?.client||n}),metric:t("platform.qwant.results.rank",{rank:K+1})}));p(y),y.length===0&&l(t("platform.qwant.errors.noneFound"))}catch(o){const u=o instanceof Error?o.message:t("platform.qwant.errors.generic");l(u),p([])}finally{g(!1)}},[n,d,t]);e.useEffect(()=>{if(!r.trim()){p([]),l(null),s.current=!1;return}s.current||(s.current=!0,c(r))},[r,c]),e.useEffect(()=>{r.trim()&&s.current&&c(r)},[n,r,c]);const T=e.useMemo(()=>m.jsx("div",{className:"platform-tool__filters",children:m.jsxs("label",{htmlFor:"qwant-client",children:[t("platform.qwant.filters.client"),m.jsx("select",{id:"qwant-client",value:n,onChange:a=>{C(a.target.value),s.current=!1},children:q.map(a=>m.jsx("option",{value:a.value,children:a.label},a.value))})]})}),[n,q,t]);return m.jsx(R,{platformName:t("platform.qwant.meta.name"),keyword:r,onKeywordChange:L,onSearch:c,description:t("platform.qwant.description"),extraFilters:T,results:k,placeholder:t("platform.qwant.placeholder"),loading:A,error:F,emptyState:t("platform.qwant.emptyState"),controls:x,onGlobalSearch:j,globalLoading:E,translate:t})};export{B as default};
