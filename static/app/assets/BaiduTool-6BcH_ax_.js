import{r as t,c as x,j as C}from"./index-BDOXOsBe.js";import{P as R}from"./PlatformToolLayout-BA_VPfgq.js";const q=n=>{const{keyword:y,setKeyword:w,searchLanguage:u,ui:m,uiFallback:d}=n,e=y??"",[S,l]=t.useState([]),[k,p]=t.useState(!1),[E,a]=t.useState(null),i=t.useRef(!1),r=t.useMemo(()=>x(m,d),[m,d]),o=t.useCallback(async L=>{const g=L.trim();if(!g){l([]),a(null);return}p(!0),a(null);try{const c=new URLSearchParams({q:g,lang:(u||"").toLowerCase()}),s=await fetch(`/api/platforms/baidu?${c.toString()}`);if(!s.ok){const f=await s.json().catch(()=>null);throw new Error(f?.error||r("platform.baidu.error.fetch"))}const b=await s.json(),h=(Array.isArray(b?.suggestions)?b.suggestions:[]).map((f,j)=>({title:f,subtitle:r("platform.baidu.subtitle"),metric:r("platform.baidu.metric.rank",{rank:j+1})}));l(h),h.length===0&&a(r("platform.baidu.error.none"))}catch(c){const s=c instanceof Error?c.message:r("platform.baidu.error.generic");a(s),l([])}finally{p(!1)}},[u,r]);return t.useEffect(()=>{if(!e.trim()){l([]),a(null),i.current=!1;return}i.current||(i.current=!0,o(e))},[e,o]),t.useEffect(()=>{e.trim()&&i.current&&o(e)},[u,e,o]),C.jsx(R,{platformName:r("platform.baidu.meta.name"),keyword:e,onKeywordChange:w,onSearch:o,description:r("platform.baidu.description"),results:S,placeholder:r("platform.baidu.placeholder"),loading:k,error:E,emptyState:r("platform.baidu.empty"),controls:n.locationControls,onGlobalSearch:n.onGlobalSearch,globalLoading:n.globalLoading,translate:r})};export{q as default};
