import{r,c as F,j as u}from"./index-VHqiCOIl.js";import{P as K}from"./PlatformToolLayout-CvAcjWun.js";const q=i=>{const{keyword:S,setKeyword:x,searchLanguage:d,ui:v}=i,a=S??"",[o,j]=r.useState("web"),[E,f]=r.useState([]),[L,g]=r.useState(!1),[k,s]=r.useState(null),l=r.useRef(!1),e=r.useMemo(()=>F(v),[v]),h=r.useMemo(()=>[{value:"web",label:e("platform.brave.source.web")},{value:"news",label:e("platform.brave.source.news")},{value:"videos",label:e("platform.brave.source.videos")}],[e]),n=r.useCallback(async t=>{const w=t.trim();if(!w){f([]),s(null);return}g(!0),s(null);try{const m=new URLSearchParams({q:w,lang:(d||"").toLowerCase(),source:o}),c=await fetch(`/api/platforms/brave?${m.toString()}`);if(!c.ok){const b=await c.json().catch(()=>null);throw new Error(b?.error||e("platform.brave.error.fetch"))}const p=await c.json(),y=(Array.isArray(p?.suggestions)?p.suggestions:[]).map((b,R)=>({title:b,subtitle:e("platform.brave.subtitle",{source:p?.metadata?.source||o}),metric:e("platform.brave.metric.rank",{rank:R+1})}));f(y),y.length===0&&s(e("platform.brave.error.none"))}catch(m){const c=m instanceof Error?m.message:e("platform.brave.error.generic");s(c),f([])}finally{g(!1)}},[o,d,e]);r.useEffect(()=>{if(!a.trim()){f([]),s(null),l.current=!1;return}l.current||(l.current=!0,n(a))},[a,n]),r.useEffect(()=>{a.trim()&&l.current&&n(a)},[o,a,n]);const C=r.useMemo(()=>u.jsx("div",{className:"platform-tool__filters",children:u.jsxs("label",{htmlFor:"brave-source",children:[e("platform.brave.filters.source"),u.jsx("select",{id:"brave-source",value:o,onChange:t=>{j(t.target.value),l.current=!1},children:h.map(t=>u.jsx("option",{value:t.value,children:t.label},t.value))})]})}),[o,h,e]);return u.jsx(K,{platformName:e("platform.brave.meta.name"),keyword:a,onKeywordChange:x,onSearch:n,description:e("platform.brave.description"),extraFilters:C,results:E,placeholder:e("platform.brave.placeholder"),loading:L,error:k,emptyState:e("platform.brave.empty"),controls:i.locationControls,onGlobalSearch:i.onGlobalSearch,globalLoading:i.globalLoading,translate:e})};export{q as default};
