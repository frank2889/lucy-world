import{r as t,j as c}from"./index-CgW13nsE.js";import{P as $}from"./PlatformToolLayout-BUBe3-FM.js";const A=[{code:"US",label:"United States"},{code:"GB",label:"United Kingdom"},{code:"CA",label:"Canada"},{code:"AU",label:"Australia"},{code:"DE",label:"Germany"},{code:"FR",label:"France"},{code:"ES",label:"Spain"},{code:"IT",label:"Italy"},{code:"NL",label:"Netherlands"},{code:"BE",label:"Belgium"},{code:"JP",label:"Japan"}],v=f=>{const p=(f||"").toUpperCase();return A.find(r=>r.code===p)?.code??"US"},L=({keyword:f,setKeyword:p,country:i})=>{const r=f??"",[u,g]=t.useState(()=>v(i)),[E,d]=t.useState([]),[j,h]=t.useState(!1),[k,a]=t.useState(null),s=t.useRef(!1),w=t.useMemo(()=>A,[]);t.useEffect(()=>{g(v(i))},[i]);const n=t.useCallback(async o=>{const S=o.trim();if(!S){d([]),a(null);return}h(!0),a(null);try{const m=new URLSearchParams({q:S,country:u,limit:"15"}),l=await fetch(`/api/platforms/appstore?${m.toString()}`);if(!l.ok){const e=await l.json().catch(()=>null);throw new Error(e?.error||"Onbekende App Store fout")}const b=await l.json(),y=(Array.isArray(b?.results)?b.results:[]).map((e,R)=>{const P=e.trackName||S,U=[e.artistName,e.primaryGenreName].filter(Boolean),C=typeof e.averageUserRating=="number"?`${e.averageUserRating.toFixed(1)}★${e.userRatingCount?` (${e.userRatingCount.toLocaleString()})`:""}`:null,N=e.formattedPrice||(typeof e.price=="number"?`${e.price===0?"Free":`${e.price} ${e.currency||""}`}`:null),O=[C,N].filter(Boolean);return{title:P,subtitle:U.join(" • ")||void 0,metric:O.join(" • ")||`Populariteit #${R+1}`}});d(y),y.length===0&&a("Geen App Store suggesties gevonden voor dit zoekwoord.")}catch(m){const l=m instanceof Error?m.message:"Onbekende fout";a(l),d([])}finally{h(!1)}},[u]);t.useEffect(()=>{if(!r.trim()){d([]),a(null),s.current=!1;return}s.current||(s.current=!0,n(r))},[r,n]),t.useEffect(()=>{r.trim()&&s.current&&n(r)},[u,r,n]);const x=c.jsx("div",{className:"platform-tool__filters",children:c.jsxs("label",{htmlFor:"appstore-country",children:["Store",c.jsx("select",{id:"appstore-country",value:u,onChange:o=>{g(o.target.value),s.current=!1},children:w.map(o=>c.jsx("option",{value:o.code,children:o.label},o.code))})]})});return c.jsx($,{platformName:"App Store",keyword:r,onKeywordChange:p,onSearch:n,description:"ASO (App Store Optimization) voor iOS applicaties.",extraFilters:x,results:E,placeholder:"Welke app zoekterm onderzoek je?",loading:j,error:k,emptyState:"Voer een zoekwoord in voor App Store suggesties."})};export{L as default};
