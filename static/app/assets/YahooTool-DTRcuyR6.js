import{r as o,c as P,j as c}from"./index-CnZ5Rj5g.js";import{P as R}from"./PlatformToolLayout-CfVQsyVx.js";const I=[5,10,15,20],K=h=>{const u=Number(h);return Number.isFinite(u)?Math.min(Math.max(Math.round(u),1),20):10},O=h=>{const{keyword:u,setKeyword:j,searchLanguage:g,country:p,ui:S,locationControls:L,onGlobalSearch:v,globalLoading:E}=h,r=u??"",[a,k]=o.useState(()=>K(void 0)),[C,m]=o.useState([]),[M,w]=o.useState(!1),[N,s]=o.useState(null),n=o.useRef(!1),t=o.useMemo(()=>P(S),[S]),l=o.useCallback(async e=>{const x=e.trim();if(!x){m([]),s(null);return}w(!0),s(null);try{const f=new URLSearchParams({q:x,lang:(g||"").toLowerCase(),country:(p||"").toUpperCase(),limit:String(a)}),i=await fetch(`/api/platforms/yahoo?${f.toString()}`);if(!i.ok){const d=await i.json().catch(()=>null);throw new Error(d?.error||t("platform.yahoo.errors.fetch"))}const y=await i.json(),b=(Array.isArray(y?.suggestions)?y.suggestions:[]).map((d,T)=>({title:d,subtitle:t("platform.yahoo.results.subtitle",{country:y?.country||p||"global"}),metric:t("platform.yahoo.results.rank",{rank:T+1})}));m(b),b.length===0&&s(t("platform.yahoo.errors.noneFound"))}catch(f){const i=f instanceof Error?f.message:t("platform.yahoo.errors.generic");s(i),m([])}finally{w(!1)}},[a,g,p,t]);o.useEffect(()=>{if(!r.trim()){m([]),s(null),n.current=!1;return}n.current||(n.current=!0,l(r))},[r,l]),o.useEffect(()=>{r.trim()&&n.current&&l(r)},[a,r,l]);const F=o.useMemo(()=>c.jsx("div",{className:"platform-tool__filters",children:c.jsxs("label",{htmlFor:"yahoo-limit",children:[t("platform.yahoo.filters.limit"),c.jsx("select",{id:"yahoo-limit",value:a,onChange:e=>{k(Number(e.target.value)),n.current=!1},children:I.map(e=>c.jsx("option",{value:e,children:e},e))})]})}),[a,t]);return c.jsx(R,{platformName:t("platform.yahoo.meta.name"),keyword:r,onKeywordChange:j,onSearch:l,description:t("platform.yahoo.description"),extraFilters:F,results:C,placeholder:t("platform.yahoo.placeholder"),loading:M,error:N,emptyState:t("platform.yahoo.emptyState"),controls:L,onGlobalSearch:v,globalLoading:E,translate:t})};export{O as default};
