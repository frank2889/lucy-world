import{r as t,c as A,j as m}from"./index-CaUPr3nC.js";import{P as F}from"./PlatformToolLayout-BYh0qkdb.js";const w=[{code:"en-US",label:"United States (English)"},{code:"en-GB",label:"United Kingdom (English)"},{code:"en-AU",label:"Australia (English)"},{code:"en-CA",label:"Canada (English)"},{code:"fr-FR",label:"France (Français)"},{code:"fr-CA",label:"Canada (Français)"},{code:"de-DE",label:"Deutschland (Deutsch)"},{code:"es-ES",label:"España (Español)"},{code:"es-MX",label:"México (Español)"},{code:"nl-NL",label:"Nederland (Nederlands)"},{code:"it-IT",label:"Italia (Italiano)"},{code:"pt-BR",label:"Brasil (Português)"},{code:"ja-JP",label:"日本 (日本語)"}],N="en-US",x=(s,h)=>{const l=(s||"").toLowerCase(),r=(h||"").toUpperCase(),i=`${l}-${r}`.toLowerCase();if(w.some(o=>o.code.toLowerCase()===i&&l&&r))return i;if(l){const o=w.find(a=>a.code.toLowerCase().startsWith(`${l}-`));if(o)return o.code}return N},T=s=>{const{keyword:h,setKeyword:l,searchLanguage:r,country:i,ui:o}=s,a=h??"",[c,E]=t.useState(()=>x(r,i)),[B,p]=t.useState([]),[j,S]=t.useState(!1),[M,d]=t.useState(null),u=t.useRef(!1),e=t.useMemo(()=>A(o),[o]);t.useEffect(()=>{E(x(r,i))},[r,i]);const g=t.useCallback(async n=>{const C=n.trim();if(!C){p([]),d(null);return}S(!0),d(null);try{const b=new URLSearchParams({q:C,mkt:c,lang:(r||"").toLowerCase()}),f=await fetch(`/api/platforms/bing?${b.toString()}`);if(!f.ok){const y=await f.json().catch(()=>null);throw new Error(y?.error||e("platform.bing.error.fetch","Unable to fetch Bing suggestions"))}const k=await f.json(),L=(Array.isArray(k?.suggestions)?k.suggestions:[]).map((y,v)=>({title:y,subtitle:e("platform.bing.subtitle","Autocompletion ({{market}})",{market:k?.market||c}),metric:e("platform.bing.metric.rank","Popularity #{{rank}}",{rank:v+1})}));p(L),L.length===0&&d(e("platform.bing.error.none","No Bing suggestions found for this keyword."))}catch(b){const f=b instanceof Error?b.message:e("platform.bing.error.generic","Unknown error");d(f),p([])}finally{S(!1)}},[c,r,e]);t.useEffect(()=>{if(!a.trim()){p([]),d(null),u.current=!1;return}u.current||(u.current=!0,g(a))},[a,g]),t.useEffect(()=>{a.trim()&&u.current&&g(a)},[c,a,g]);const U=m.jsx("div",{className:"platform-tool__filters",children:m.jsxs("label",{htmlFor:"bing-market",children:[e("platform.bing.filters.market","Market"),m.jsx("select",{id:"bing-market",value:c,onChange:n=>{E(n.target.value),u.current=!1},children:w.map(n=>m.jsx("option",{value:n.code,children:n.label},n.code))})]})});return m.jsx(F,{platformName:e("platform.bing.meta.name","Bing"),keyword:a,onKeywordChange:l,onSearch:g,description:e("platform.bing.description","Search optimization insights for Microsoft Bing."),extraFilters:U,results:B,placeholder:e("platform.bing.placeholder","Which keyword do you want to rank on Bing?"),loading:j,error:M,emptyState:e("platform.bing.empty","Enter a keyword to uncover Bing opportunities."),controls:s.locationControls,onGlobalSearch:s.onGlobalSearch,globalLoading:s.globalLoading,translate:e})};export{T as default};
