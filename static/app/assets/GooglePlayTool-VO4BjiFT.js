import{r,c as O,j as g}from"./index-B_bW3Ap_.js";import{P as K}from"./PlatformToolLayout-D8L_NNlt.js";const x=[{code:"US",label:"United States"},{code:"GB",label:"United Kingdom"},{code:"CA",label:"Canada"},{code:"AU",label:"Australia"},{code:"DE",label:"Germany"},{code:"FR",label:"France"},{code:"ES",label:"Spain"},{code:"IT",label:"Italy"},{code:"NL",label:"Netherlands"},{code:"BR",label:"Brazil"},{code:"IN",label:"India"}],R=p=>{const f=(p||"").toUpperCase();return x.find(l=>l.code===f)?.code??"US"},B=p=>{const{keyword:f,setKeyword:P,searchLanguage:l,country:y,ui:b,locationControls:C,onGlobalSearch:U,globalLoading:j,getCountryName:S}=p,a=f??"",[t,w]=r.useState(()=>R(y)),[A,u]=r.useState([]),[L,k]=r.useState(!1),[N,n]=r.useState(null),s=r.useRef(!1),e=r.useMemo(()=>O(b),[b]),v=r.useMemo(()=>x.map(o=>({code:o.code,label:S?.(o.code)??e(`platform.googlePlay.regions.${o.code}`,o.label)})),[S,e]);r.useEffect(()=>{w(R(y))},[y]);const c=r.useCallback(async o=>{const E=o.trim();if(!E){u([]),n(null);return}k(!0),n(null);try{const d=new URLSearchParams({q:E,country:t,lang:(l||"").toLowerCase(),limit:"10"}),i=await fetch(`/api/platforms/googleplay?${d.toString()}`);if(!i.ok){const h=await i.json().catch(()=>null);throw new Error(h?.error||e("platform.googlePlay.errors.unknownResponse","Unknown Google Play error"))}const m=await i.json(),G=(Array.isArray(m?.suggestions)?m.suggestions:[]).map((h,I)=>({title:h,subtitle:e("platform.googlePlay.results.subtitle","Search suggestion ({{country}})",{country:(m?.country?.toUpperCase()||t)??t}),metric:e("platform.googlePlay.results.rank","Popularity #{{rank}}",{rank:I+1})}));u(G),G.length===0&&n(e("platform.googlePlay.errors.noneFound","No Google Play suggestions found for this keyword."))}catch(d){const i=d instanceof Error?d.message:e("platform.googlePlay.errors.generic","Unknown error");n(i),u([])}finally{k(!1)}},[t,l,e]);r.useEffect(()=>{if(!a.trim()){u([]),n(null),s.current=!1;return}s.current||(s.current=!0,c(a))},[a,c]),r.useEffect(()=>{a.trim()&&s.current&&c(a)},[t,l,a,c]);const F=g.jsx("div",{className:"platform-tool__filters",children:g.jsxs("label",{htmlFor:"google-play-region",children:[e("platform.googlePlay.filters.region","Region"),g.jsx("select",{id:"google-play-region",value:t,onChange:o=>{w(o.target.value),s.current=!1},children:v.map(o=>g.jsx("option",{value:o.code,children:o.label},o.code))})]})});return g.jsx(K,{platformName:e("platform.googlePlay.meta.name","Google Play"),keyword:a,onKeywordChange:P,onSearch:c,description:e("platform.googlePlay.description","ASO for Android apps in Google Play."),extraFilters:F,results:A,placeholder:e("platform.googlePlay.form.placeholder","Which Android keyword are you researching?"),loading:L,error:N,emptyState:e("platform.googlePlay.emptyState","Enter a keyword to see Google Play opportunities."),controls:C,onGlobalSearch:U,globalLoading:j,translate:e})};export{B as default};
