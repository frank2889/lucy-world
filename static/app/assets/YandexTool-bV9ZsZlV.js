import{r as o,j as f}from"./index-DbsFPuxG.js";import{P as C}from"./PlatformToolLayout-Cks7JTvg.js";const k=[{code:"213",label:"Россия — Москва",countries:["RU"]},{code:"2",label:"Россия — Санкт-Петербург",countries:["RU"]},{code:"187",label:"Україна",countries:["UA"]},{code:"157",label:"Беларусь",countries:["BY"]},{code:"163",label:"Қазақстан",countries:["KZ"]},{code:"225",label:"Россия — вся страна",countries:["RU"]},{code:"0",label:"Все регионы",countries:[]}],R=p=>{const g=(p||"").toUpperCase(),t=k.find(n=>n.countries.includes(g));return t?t.code:"225"},N=({keyword:p,setKeyword:g,searchLanguage:t,country:n})=>{const r=p??"",[a,y]=o.useState(()=>R(n)),[v,m]=o.useState([]),[j,b]=o.useState(!1),[E,l]=o.useState(null),c=o.useRef(!1),S=o.useMemo(()=>{const e=new Map;for(const s of k)e.has(s.code)||e.set(s.code,{code:s.code,label:s.label});return Array.from(e.values())},[]);o.useEffect(()=>{y(R(n))},[n]);const i=o.useCallback(async e=>{const s=e.trim();if(!s){m([]),l(null);return}b(!0),l(null);try{const u=new URLSearchParams({q:s,lr:a});t&&u.set("lang",t.toLowerCase());const d=await fetch(`/api/platforms/yandex?${u.toString()}`);if(!d.ok){const x=await d.json().catch(()=>null);throw new Error(x?.error||"Onbekende Yandex fout")}const h=await d.json(),w=(Array.isArray(h?.suggestions)?h.suggestions:[]).map((x,Y)=>({title:x,subtitle:`Запрос (${h?.region||a||"все регионы"})`,metric:`Популярность #${Y+1}`}));m(w),w.length===0&&l("Geen Yandex suggesties gevonden voor dit zoekwoord.")}catch(u){const d=u instanceof Error?u.message:"Onbekende fout";l(d),m([])}finally{b(!1)}},[a,t]);o.useEffect(()=>{if(!r.trim()){m([]),l(null),c.current=!1;return}c.current||(c.current=!0,i(r))},[r,i]),o.useEffect(()=>{r.trim()&&c.current&&i(r)},[a,t,r,i]);const z=f.jsx("div",{className:"platform-tool__filters",children:f.jsxs("label",{htmlFor:"yandex-region",children:["Regio",f.jsx("select",{id:"yandex-region",value:a,onChange:e=>{y(e.target.value),c.current=!1},children:S.map(e=>f.jsx("option",{value:e.code,children:e.label},e.code))})]})});return f.jsx(C,{platformName:"Yandex",keyword:r,onKeywordChange:g,onSearch:i,description:"Lokale zoektermen voor Yandex ecosysteem.",extraFilters:z,results:v,placeholder:"Welke Russische zoekterm onderzoek je?",loading:j,error:E,emptyState:"Voer een zoekwoord in voor Yandex inzichten."})};export{N as default};
