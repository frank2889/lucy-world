import{r as a,c as U,j as g}from"./index-C9S1em3K.js";import{P as N}from"./PlatformToolLayout-Cr6iLB8k.js";const w=[{code:"en-US",label:"United States (English)"},{code:"en-GB",label:"United Kingdom (English)"},{code:"en-AU",label:"Australia (English)"},{code:"en-CA",label:"Canada (English)"},{code:"fr-FR",label:"France (Français)"},{code:"fr-CA",label:"Canada (Français)"},{code:"de-DE",label:"Deutschland (Deutsch)"},{code:"es-ES",label:"España (Español)"},{code:"es-MX",label:"México (Español)"},{code:"nl-NL",label:"Nederland (Nederlands)"},{code:"it-IT",label:"Italia (Italiano)"},{code:"pt-BR",label:"Brasil (Português)"},{code:"ja-JP",label:"日本 (日本語)"}],B="en-US",j=(l,k)=>{const s=(l||"").toLowerCase(),t=(k||"").toUpperCase(),c=`${s}-${t}`.toLowerCase();if(w.some(r=>r.code.toLowerCase()===c&&s&&t))return c;if(s){const r=w.find(b=>b.code.toLowerCase().startsWith(`${s}-`));if(r)return r.code}return B},D=l=>{const{keyword:k,setKeyword:s,searchLanguage:t,country:c,ui:r,uiFallback:b}=l,o=k??"",[i,S]=a.useState(()=>j(t,c)),[F,p]=a.useState([]),[M,C]=a.useState(!1),[v,d]=a.useState(null),u=a.useRef(!1),e=a.useMemo(()=>U(r,b),[r,b]);a.useEffect(()=>{S(j(t,c))},[t,c]);const f=a.useCallback(async n=>{const L=n.trim();if(!L){p([]),d(null);return}C(!0),d(null);try{const h=new URLSearchParams({q:L,mkt:i,lang:(t||"").toLowerCase()}),m=await fetch(`/api/platforms/bing?${h.toString()}`);if(!m.ok){const E=await m.json().catch(()=>null);throw new Error(E?.error||e("platform.bing.error.fetch"))}const y=await m.json(),x=(Array.isArray(y?.suggestions)?y.suggestions:[]).map((E,R)=>({title:E,subtitle:e("platform.bing.subtitle",{market:y?.market||i}),metric:e("platform.bing.metric.rank",{rank:R+1})}));p(x),x.length===0&&d(e("platform.bing.error.none"))}catch(h){const m=h instanceof Error?h.message:e("platform.bing.error.generic");d(m),p([])}finally{C(!1)}},[i,t,e]);a.useEffect(()=>{if(!o.trim()){p([]),d(null),u.current=!1;return}u.current||(u.current=!0,f(o))},[o,f]),a.useEffect(()=>{o.trim()&&u.current&&f(o)},[i,o,f]);const A=g.jsx("div",{className:"platform-tool__filters",children:g.jsxs("label",{htmlFor:"bing-market",children:[e("platform.bing.filters.market"),g.jsx("select",{id:"bing-market",value:i,onChange:n=>{S(n.target.value),u.current=!1},children:w.map(n=>g.jsx("option",{value:n.code,children:n.label},n.code))})]})});return g.jsx(N,{platformName:e("platform.bing.meta.name"),keyword:o,onKeywordChange:s,onSearch:f,description:e("platform.bing.description"),extraFilters:A,results:F,placeholder:e("platform.bing.placeholder"),loading:M,error:v,emptyState:e("platform.bing.empty"),controls:l.locationControls,onGlobalSearch:l.onGlobalSearch,globalLoading:l.globalLoading,translate:e})};export{D as default};
