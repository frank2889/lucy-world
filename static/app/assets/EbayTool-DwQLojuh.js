import{r as t,c as T,j as y}from"./index-C-suCUV6.js";import{P as v}from"./PlatformToolLayout-Dv7YUvVj.js";const m=[{country:"US",siteId:"0",label:"United States (eBay.com)"},{country:"CA",siteId:"2",label:"Canada (eBay.ca)"},{country:"GB",siteId:"3",label:"United Kingdom (eBay.co.uk)"},{country:"AU",siteId:"15",label:"Australia (eBay.com.au)"},{country:"AT",siteId:"16",label:"Austria (eBay.at)"},{country:"FR",siteId:"71",label:"France (eBay.fr)"},{country:"DE",siteId:"77",label:"Germany (eBay.de)"},{country:"BE",siteId:"23",label:"Belgium (eBay.be)"},{country:"IT",siteId:"101",label:"Italy (eBay.it)"},{country:"NL",siteId:"146",label:"Netherlands (eBay.nl)"},{country:"ES",siteId:"186",label:"Spain (eBay.es)"}],F="0",x=s=>{const p=(s||"").toUpperCase();return m.find(r=>r.country===p)?.siteId??F},D=s=>{const{keyword:p,setKeyword:g,country:r,ui:h}=s,o=p??"",[n,I]=t.useState(()=>x(r)),[U,d]=t.useState([]),[j,S]=t.useState(!1),[A,l]=t.useState(null),i=t.useRef(!1),e=t.useMemo(()=>T(h),[h]),B=t.useMemo(()=>m.find(a=>a.siteId===n)??m[0],[n]);t.useEffect(()=>{I(x(r))},[r]);const c=t.useCallback(async a=>{const E=a.trim();if(!E){d([]),l(null);return}S(!0),l(null);try{const f=new URLSearchParams({q:E,siteId:n,country:(r||"").toUpperCase(),max:"10"}),u=await fetch(`/api/platforms/ebay?${f.toString()}`);if(!u.ok){const b=await u.json().catch(()=>null);throw new Error(b?.error||e("platform.ebay.error.fetch","Unable to fetch eBay suggestions"))}const k=await u.json(),w=(Array.isArray(k?.suggestions)?k.suggestions:[]).map((b,L)=>({title:b,subtitle:e("platform.ebay.subtitle","Search suggestion from {{marketplace}}",{marketplace:B.label}),metric:e("platform.ebay.metric.rank","Popularity #{{rank}}",{rank:L+1})}));d(w),w.length===0&&l(e("platform.ebay.error.none","No eBay suggestions found for this keyword."))}catch(f){const u=f instanceof Error?f.message:e("platform.ebay.error.generic","Unknown error");l(u),d([])}finally{S(!1)}},[n,r,B.label,e]);t.useEffect(()=>{if(!o.trim()){d([]),l(null),i.current=!1;return}i.current||(i.current=!0,c(o))},[o,c]),t.useEffect(()=>{o.trim()&&i.current&&c(o)},[n,o,c]);const C=y.jsx("div",{className:"platform-tool__filters",children:y.jsxs("label",{htmlFor:"ebay-site",children:[e("platform.ebay.filters.marketplace","Marketplace"),y.jsx("select",{id:"ebay-site",value:n,onChange:a=>{I(a.target.value),i.current=!1},children:m.map(a=>y.jsx("option",{value:a.siteId,children:a.label},a.siteId))})]})});return y.jsx(v,{platformName:e("platform.ebay.meta.name","eBay"),keyword:o,onKeywordChange:g,onSearch:c,description:e("platform.ebay.description","Listing and pricing insights for eBay."),extraFilters:C,results:U,placeholder:e("platform.ebay.placeholder","Which product are you selling on eBay?"),loading:j,error:A,emptyState:e("platform.ebay.empty","Enter a keyword to see eBay insights."),controls:s.locationControls,onGlobalSearch:s.onGlobalSearch,globalLoading:s.globalLoading,translate:e})};export{D as default};
