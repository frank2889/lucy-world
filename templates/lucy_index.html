<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lucy World — Keyword Research</title>
  <meta name="description" content="Lucy World: snelle, gratis keyword research met realtime suggesties en trends." />
  <style>
    :root { --bg:#0b0d10; --card:#14181e; --text:#e6e8eb; --muted:#9aa4af; --accent:#6ee7b7; --line:#262b33; }
    *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;background:var(--bg);color:var(--text)}
    header{padding:28px 20px;border-bottom:1px solid var(--line)}
    .wrap{max-width:980px;margin:0 auto;padding:20px}
    .brand{font-weight:700;letter-spacing:.2px}
    .brand span{color:var(--accent)}
    .search-card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:22px}
    .row{display:flex;gap:12px}
    input[type=text]{flex:1;appearance:none;background:#0e1217;color:var(--text);border:1px solid var(--line);border-radius:10px;padding:14px 14px;font-size:16px}
    button{background:var(--accent);color:#062a20;border:0;border-radius:10px;padding:14px 18px;font-weight:600;cursor:pointer}
    button[disabled]{opacity:.6;cursor:progress}
    .hint{color:var(--muted);font-size:13px;margin-top:8px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin-top:18px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:18px}
    .kpi{display:flex;gap:18px}
    .kpi .item{flex:1}
    .kpi .label{color:var(--muted);font-size:12px}
    h3{margin:0 0 6px 0;font-size:18px}
    h4{margin:0 0 10px 0;font-size:15px;color:var(--muted)}
    .pill{display:inline-block;background:#0e1217;border:1px solid var(--line);padding:6px 10px;border-radius:999px;margin:4px 6px 0 0;font-size:13px}
    footer{padding:28px 20px;color:var(--muted);border-top:1px solid var(--line);margin-top:40px;font-size:13px}
    .hidden{display:none}
  </style>
</head>
<body>
  <header>
    <div class="wrap brand">Lucy <span>World</span></div>
  </header>
  <main class="wrap">
    <section class="search-card">
      <h3>Keyword onderzoek</h3>
      <form id="searchForm" class="row">
        <input type="text" id="keyword" name="keyword" placeholder="Voer een zoekwoord in (bijv. pizza bestellen)" required />
        <input type="hidden" id="language" name="language" value="nl" />
        <button id="searchBtn" type="submit">Zoeken</button>
      </form>
      <div class="hint">Gratis suggesties en trends. Resultaten verschijnen hieronder.</div>
    </section>

    <section id="summary" class="grid hidden">
      <div class="card" style="grid-column:span 12">
        <div class="kpi">
          <div class="item"><div class="label">Totaal keywords</div><div id="kpiKeywords" style="font-size:22px;font-weight:700">0</div></div>
          <div class="item"><div class="label">Totaal volume</div><div id="kpiVolume" style="font-size:22px;font-weight:700">0</div></div>
          <div class="item"><div class="label">Echte data keywords</div><div id="kpiReal" style="font-size:22px;font-weight:700">0</div></div>
          <div class="item"><div class="label">Gem. interesse</div><div id="kpiInterest" style="font-size:22px;font-weight:700">—</div></div>
        </div>
      </div>
    </section>

    <section id="results" class="grid hidden"></section>
  </main>
  <footer>
    © <span id="year"></span> Lucy World
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    const form = document.getElementById('searchForm');
    const btn = document.getElementById('searchBtn');
    const resultsEl = document.getElementById('results');
    const summaryEl = document.getElementById('summary');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const keyword = document.getElementById('keyword').value.trim();
      const language = document.getElementById('language').value || 'nl';
      if (!keyword) return;
      btn.disabled = true; btn.textContent = 'Zoeken…';
      try {
        const res = await fetch('/search', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: `keyword=${encodeURIComponent(keyword)}&language=${encodeURIComponent(language)}`
        });
        if (!res.ok) throw new Error('Zoekopdracht mislukt');
        const data = await res.json();
        renderSummary(data.summary, data.trends);
        renderResults(data.categories);
      } catch (err) {
        alert('Er is een fout opgetreden bij het zoeken. Probeer het opnieuw.');
        console.error(err);
      } finally { btn.disabled = false; btn.textContent = 'Zoeken'; }
    });

    function nl(num){return Number(num||0).toLocaleString('nl-NL');}
    function renderSummary(summary={}, trends={}){
      document.getElementById('kpiKeywords').textContent = nl(summary.total_keywords||0);
      document.getElementById('kpiVolume').textContent = nl(summary.total_volume||0);
      document.getElementById('kpiReal').textContent = nl(summary.real_data_keywords||0);
      document.getElementById('kpiInterest').textContent = (trends.avg_interest||0).toString();
      summaryEl.classList.remove('hidden');
    }
    function renderResults(categories={}){
      resultsEl.innerHTML='';
      const order=['google_suggestions','trends_related','related_questions','wikipedia_terms'];
      (order.concat(Object.keys(categories))).filter((v,i,self)=>self.indexOf(v)===i).forEach(cat=>{
        const items = categories[cat];
        if(!items||!items.length) return;
        const card = document.createElement('div');
        card.className='card'; card.style.gridColumn='span 12';
        const title = cat.replace(/_/g,' ');
        card.innerHTML = `<h4>${title}</h4>` + items.map(it=>
          `<span class="pill">${it.keyword} · ${nl(it.search_volume||0)}</span>`
        ).join('');
        resultsEl.appendChild(card);
      });
      resultsEl.classList.remove('hidden');
    }
  </script>
</body>
</html>